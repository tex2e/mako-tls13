---
title: TLS事始め
tags:
sidebar: doc_sidebar
permalink: introduction.html
---

## はじめに

インターネットの前身であるARPANETが設計された当時はネットに接続する人は大学関係者と限られていたので、性善説に基づいて通信路を暗号化する必要はありませんでした。平文パケットは郵便はがきと同じように誰でも見ることができますが、その中身を記録・取集して悪用する人はいませんでした。しかし、誰もがインターネットに参加する現代では、悪意のある人やプロバイダが、飛び交うパケットを捕らえて通信内容を調べるかもしれません。実際にNSAはPRISMによる広域盗聴をし、XKeyscoreで解析をすることで個人情報の収集をしていました。通信内容から個人情報やパスワード、クレジットカード番号などを収集されては、安心してインターネットを利用することはできません。
この問題をアプリケーション層とトランスポート層の間で解決するのがTLS (Transport Layer Security) です。

## TLSの特性

TLS は任意のプロトコルを安全に送受信するためのものです。
TLS は次の3つの特性を持ちます。

- 真正性 : 通信相手や情報が本物で確かである特性 (サーバ証明書などによる認証)
- 機密性 : 権限を持つ人だけが通信内容にアクセスできる特性 (通信内容の暗号化)
- 完全性 : 改ざんされることなく正確な状態を保つ特性 (ハッシュによる改ざん検知)

認証によりサーバやクライアントが正しい通信相手であるか確認することができ、暗号化により通信の盗聴を防ぐことができ、改ざん検知により通信中のデータの不正あるいは障害によるデータの誤りを検知することができます。

## TLS 1.2との違い

TLS 1.3はTLS 1.2と比較したときの主な変更点には、次のようなものがあります。

- 暗号アルゴリズムの選別 : **認証付き暗号(AEAD)**だけが使えるようになりました。これにより、互換性用の安全でないアルゴリズムが削除され、暗号文の改ざんが検知可能となりました。
- **前方秘匿性**の徹底 : セッション鍵を通信毎に破棄します。セッション鍵を使い回すことは、秘密鍵が漏れたときに過去の全ての通信が復号できることになりかねません。
- プロトコルの改良 : ハンドシェイクの往復回数が 2-RTT から 1-RTT に減少しました。これにより通信が高速化されました。他にも、ClientHelloとServerHelloで鍵共有した後のハンドシェイクは全て暗号化するようになりました。これによりサーバ証明書の送信データも暗号化されるようになりました。

## SSL/TLSプロトコルの歴史

SSL/TLSプロトコルの歴史について説明します[^JPNIC] [^bulletproof]。

1994年にSSL 1.0はNetscape社で開発されました。
しかし、公開前に設計に問題が発見されたことで公開はされず、同1994年にSSL 2.0として公開され、翌1995年にはセキュリティ上の問題を修正したSSL 3.0が公開されました。
ブラウザとしてはNetscape Navigator 1.1や、Microsoft Internet Explorer 2.0に初めてHTTPS機能が搭載され、サーバ側でもApache HTTP ServerをHTTPS対応にするための、OpenSSLの前身となったライブラリ、SSLeayがリリースされ、SSLの普及が大いに加速しました。

1996年以降、SSLの標準化はNetscape社からIETF TLSワーキンググループに移管され、1999年にSSL 3.0とほぼ同等のTLS 1.0 (RFC 2246)がリリースされました。この新しいプロトコルとSSL 3.0の違いはわずかですが、それでも両バージョンには互換性がありません。当時はNetscape社とMicrosoft社の激しいブラウザ市場シェアの争奪戦 (第一次ブラウザ戦争) があり、Netscapeが作ったSSLの名前を使わずに、Microsoft社の意向でTLSと名前をつけました[^TimDierks]。

2006年には、TLS 1.1 (RFC 4346)がリリースされ、CBCブロック暗号モードに対する攻撃への対応などセキュリティ機能を強化しました。

2008年には、TLS 1.2 (RFC 5246)がリリースされ、認証付き暗号(AEAD)が導入されました。また、MD5やSHA1などのハッシュ関数がSHA256などのより安全なものに置き換えられました。

2018年には、TLS 1.3 (RFC 8446)がリリースされ、使える暗号が認証付き暗号(AEAD)だけとなり、互換性用の安全でないアルゴリズムが削除されました。
また、前方秘匿性を持つようになり、よりセキュリティ機能が強化されました。
加えて、プロトコルの改良により、RTTが2回から1回になることで通信速度が向上しました。



-----

[^JPNIC]: [SSL/TLS 20年の歩みと動向 -- JPNIC](https://www.nic.ad.jp/ja/newsletter/No59/0800.html)
[^bulletproof]: [プロフェッショナルSSL/TLS -- Ivan Ristić, 齋藤 孝道](https://www.lambdanote.com/collections/ssl-tls)
[^TimDierks]: [Tim Dierks: Security Standards and Name Changes in the Browser Wars](http://tim.dierks.org/2014/05/security-standards-and-name-changes-in.html)
